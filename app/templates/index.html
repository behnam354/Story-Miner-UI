{% extends "base.html" %}

{% block content %}
<script type="text/javascript">
    $(function() {
        $('form').submit(function() {
            $(':submit').attr('disabled', 'disabled');
            document.getElementById("state").innerHTML = 'Processing... Please wait.';
			document.getElementById("output").innerHTML = '';
        });
    });
	$(document).ready(function () {
		// Handler for .ready() called.
		$('html, body').animate({
			scrollTop: $('#state').offset().top
		}, 'slow');
	});
	
</script>

<form action='' method='post' name='input'>
	{{ form.hidden_tag() }}
	<p>
		{{form.text(rows='10', cols='100', id ='form', placeholder="Enter some contents in this field.", 
					style='width: 100%;', class = 'form-control')}}
			{% for error in form.text.errors %}
				<div id='err' class="alert alert-danger">{{ error }}</div>
			{% endfor %}
	</p>
	<p>
		<span>{{ form.showRels }} show relationships </span>&nbsp;&nbsp
		<span>{{ form.rankRels }} rank relationships </span>&nbsp;&nbsp
		<span>{{ form.rankEntities }} rank entities </span>&nbsp;&nbsp
		<span>{{ form.showGraph }} show graph </span>
	</p>
	<p>
	<input type="submit" value="submit" class="btn btn-primary btn-lg" style='background-color:#111111' >&nbsp&nbsp
	<span id='state'></span>
	</p>
	
</form>
<div class='page' id='output'> 
{% if state|string() == "Succeeded!"%}
<div  class="alert alert-success">{{state}}</div>
{% elif state|string() == "No relationships extracted."  %}
<div  class="alert alert-warning">{{state}}</div>
{% endif%}

{% if tables %}
	{% for table in tables %}
		<h2 class="text-primary">{{titles[loop.index-1]}}</h2>
		<div>
		  <div style='overflow:scroll;max-height:420px;'>
					{{ table|safe }}<br>
		   </div>
		</div>
	{% endfor %}
{% endif %}
	
{% if graph %}	
	<h2 class="text-primary">{{graphTitle}}</h2>
	<p class = "well">
		Note: You may zoom the graph and drag the nodes. 
	</p>
	<div id = 'chartId' style = 'box-shadow: inset 0 0 1em #ccc, 0 0 1em #fff;'>	
		<script>
			// get json data
			var jsondata = {{graph|tojson}}
			var dataset = JSON.parse(jsondata);
			console.log(dataset);
			drawGraph(dataset);
		</script>

	</div>
{% endif %}

</div>





{% endblock %}
